
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user within the Loni Panchayat Tax Management System.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "User's display name."
        },
        "role": {
          "type": "string",
          "description": "User's role.",
          "enum": ["admin", "operator", "viewer", "citizen"]
        }
      },
      "required": [
        "id",
        "email",
        "displayName",
        "role"
      ]
    },
    "Property": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Property",
      "type": "object",
      "description": "Represents a property registered in the Loni Panchayat Tax Management System.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Property entity."
        },
        "ownerId": {
          "type": "string",
          "description": "Reference to User (owner). (Relationship: User 1:N Property)"
        },
        "houseNumber": {
          "type": "string",
          "description": "House number of the property."
        },
        "propertyType": {
          "type": "string",
          "description": "Type of property (Residential/Commercial/Agricultural)."
        },
        "area": {
          "type": "number",
          "description": "Area of the property in sq.ft or acres."
        },
        "propertyPhotos": {
          "type": "array",
          "description": "Url of property photo proof.",
          "items": {
            "type": "string"
          }
        },
        "aadhaarNumber": {
          "type": "string",
          "description": "Aadhaar number of the owner (encrypted)."
        }
      },
      "required": [
        "id",
        "ownerId",
        "houseNumber",
        "propertyType",
        "area"
      ]
    },
    "TaxRecord": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TaxRecord",
      "type": "object",
      "description": "Represents a tax record for a property in the Loni Panchayat Tax Management System.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the TaxRecord entity."
        },
        "propertyId": {
          "type": "string",
          "description": "Reference to Property. (Relationship: Property 1:N TaxRecord)"
        },
        "assessmentYear": {
          "type": "number",
          "description": "Year for which the tax is assessed."
        },
        "taxType": {
          "type": "string",
          "description": "Type of tax (e.g., House Tax, Land Tax)."
        },
        "assessedAmount": {
          "type": "number",
          "description": "Amount of tax assessed."
        },
        "amountDue": {
          "type": "number",
          "description": "Amount of tax still due."
        },
        "amountPaid": {
          "type": "number",
          "description": "Amount of tax paid."
        },
        "paymentStatus": {
          "type": "string",
          "description": "Payment status (Paid/Unpaid/Partial)."
        },
        "paymentDate": {
          "type": "string",
          "description": "Date of payment.",
          "format": "date-time"
        },
        "receiptNumber": {
          "type": "string",
          "description": "Receipt number for the payment."
        }
      },
      "required": [
        "id",
        "propertyId",
        "assessmentYear",
        "taxType",
        "assessedAmount",
        "amountDue",
        "amountPaid",
        "paymentStatus"
      ]
    },
    "Payment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Payment",
      "type": "object",
      "description": "Represents a payment made for a tax record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Payment entity."
        },
        "taxRecordId": {
          "type": "string",
          "description": "Reference to TaxRecord. (Relationship: TaxRecord 1:N Payment)"
        },
        "amount": {
          "type": "number",
          "description": "Amount paid in this payment."
        },
        "paymentDate": {
          "type": "string",
          "description": "Date of the payment.",
          "format": "date-time"
        },
        "paymentMode": {
          "type": "string",
          "description": "Payment mode (Cash/UPI/Card/Bank)."
        },
        "receiptNumber": {
          "type": "string",
          "description": "Receipt number for the payment."
        },
        "receiptImageURL": {
          "type": "string",
          "description": "URL of the uploaded receipt image."
        }
      },
      "required": [
        "id",
        "taxRecordId",
        "amount",
        "paymentDate",
        "paymentMode"
      ]
    },
    "Bill": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Bill",
      "type": "object",
      "description": "Represents a generated bill or receipt for a property's taxes.",
      "properties": {
        "billId": {
          "type": "string",
          "description": "Unique identifier for the bill, e.g., LONI-2025-000123."
        },
        "propertyId": {
          "type": "string",
          "description": "The ID of the property this bill is for."
        },
        "ownerName": {
          "type": "string",
          "description": "Denormalized owner name for quick display."
        },
        "houseNo": {
          "type": "string",
          "description": "Denormalized house number."
        },
        "year": {
          "type": "number",
          "description": "The assessment year this bill covers."
        },
        "taxBreakdown": {
          "type": "array",
          "items": { "$ref": "#/entities/TaxRecord" }
        },
        "totalAmount": {
          "type": "number"
        },
        "amountPaid": {
          "type": "number"
        },
        "status": {
          "type": "string",
          "enum": ["Paid", "Unpaid", "Partial"]
        },
        "generatedBy": {
          "type": "string",
          "description": "UID of the admin who generated the bill."
        },
        "generatedAt": {
          "type": "string",
          "format": "date-time"
        },
        "storageUrlPdf": {
          "type": "string",
          "description": "Path to the PDF file in Firebase Storage."
        },
        "storageUrlDocx": {
          "type": "string",
          "description": "Path to the DOCX file in Firebase Storage (optional)."
        },
        "language": {
          "type": "string",
          "enum": ["en", "hi", "bilingual"]
        }
      },
      "required": ["billId", "propertyId", "year", "totalAmount", "status", "generatedBy", "generatedAt", "storageUrlPdf"]
    },
    "AuditLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AuditLog",
      "type": "object",
      "description": "Records significant actions performed by users, especially admins.",
      "properties": {
        "logId": { "type": "string" },
        "action": { "type": "string", "description": "e.g., 'generateBill', 'updateProperty', 'deleteUser'" },
        "timestamp": { "type": "string", "format": "date-time" },
        "userId": { "type": "string", "description": "UID of the user who performed the action." },
        "details": { "type": "object", "description": "Contextual details about the action." }
      },
      "required": ["logId", "action", "timestamp", "userId"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/entities/User"
          },
          "description": "Stores user profiles. The `userId` parameter matches the Firebase Auth UID."
        }
      },
      {
        "path": "/properties/{propertyId}",
        "definition": {
          "entityName": "Property",
          "schema": {
            "$ref": "#/entities/Property"
          },
          "description": "Stores all property records."
        }
      },
      {
        "path": "/bills/{billId}",
        "definition": {
          "entityName": "Bill",
          "schema": { "$ref": "#/entities/Bill" },
          "description": "Stores generated bills/receipts. The document ID is the unique billId."
        }
      },
      {
        "path": "/auditLogs/{logId}",
        "definition": {
          "entityName": "AuditLog",
          "schema": { "$ref": "#/entities/AuditLog" },
          "description": "Stores a log of important system events."
        }
      },
      {
        "path": "/panchayat-settings/config",
        "definition": {
            "entityName": "PanchayatSettings",
            "schema": { "$ref": "#/entities/PanchayatSettings" },
            "description": "Singleton document for global panchayat settings."
        }
      }
    ]
  }
}
